name: Hapus Log Deployments Cloudflare Pages (Spesifik)

on:
  workflow_dispatch:

jobs:
  hapus-log-cloudflare:
    runs-on: ubuntu-latest

    env:
      TARGET_PAGES: "bot" # Ganti dengan proyek spesifik

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Install jq
        run: sudo apt-get install jq -y

      - name: Debug Output JSON
        run: |
          API_TOKEN="${{ secrets.CF_API_TOKEN }}"
          ACCOUNT_ID="${{ secrets.CF_ACCOUNT_ID }}"
          CLOUDFLARE_API="https://api.cloudflare.com/client/v4"
          HEADER_AUTH="Authorization: Bearer $API_TOKEN"
          HEADER_CT="Content-Type: application/json"

          echo "ðŸ“Œ Mengecek daftar Pages Projects..."
          RESPONSE=$(curl -s -X GET "$CLOUDFLARE_API/accounts/$ACCOUNT_ID/pages/projects" \
            -H "$HEADER_AUTH" -H "$HEADER_CT")

          echo "ðŸ“Œ Output JSON dari API (formatted):"
          echo "$RESPONSE" | jq .

          # Cek apakah proyek target ada
